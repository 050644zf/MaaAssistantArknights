# 战斗流程协议

`resource/battle/*.json` 的使用方法及各字段说明

## 完整字段一览

```jsonc
{
    "stage_name": "暴君",           // 关卡名，必选
    "opers": [                      // 指定干员
        {
            "name": "棘刺",         // 干员名

            "skill": 3,             // 技能序号。可选，默认 1，取值范围 [1, 3]

            "skill_usage": 0        // 技能用法。可选，默认 0
                                    // 0 - 好了就用，有多少次用多少次（例如干员 棘刺 3 技能、桃金娘 1 技能等）
                                    // 1 - 好了就用，仅使用一次（例如干员 山 2 技能）
                                    // 2 - 自动判断使用时机（画饼.jpg）
                                    // 3 - 不自动使用（依赖 "actions" 字段）
                                    // 如果是全自动的技能，随便填哪个都一样，也可以不填
        },
    ],
    "opers_groups": [
        {
            "name": "任意正常群奶",  // 群组名，必选
                                    // 自己随便取名字，与下面 deploy 中的 name 对应起来就行

            "opers": [              // 干员任选其一，无序，会优先选练度高的，用法同上述 opers 字段
                {
                    "name": "夜莺",
                    "skill": 3,
                    "skill_usage": 2 // 若是指定时刻，不同的干员技能 cd 可能不同，请留意
                },
                {
                    "name": "白面鸮",
                    "skill": 2,
                    "skill_usage": 2
                }
            ]
        }
    ],
    "actions": [                    // 战斗中的操作。有序，执行完前一个才会去执行下一个。必选
        {
            "type": 0,              // 操作类型，可选，默认 0
                                    // 0 - 部署； 1 - 撤退； 2 - 开技能；
                                    // 100 - 切换二倍速开关；101 - 切换 1/5 速度（点击任意干员）
                                    // 若为 0, 当费用不够时，会一直等待到费用够（除非 timeout）
                                    // 若为 2, 当技能 cd 没转好时，一直等待到技能 cd 好（除非 timeout）

            "kills_condition": 0,   // 击杀数条件，如果没达到就一直等待，可选，默认为空。直接执行
            // TODO: 其他条件
            // TODO: "condition_type": 0,    // 执行条件间的关系，可选，默认 0
            //                        // 0 - 且； 1 - 或

            "name": "棘刺",         // 干员名 或 群组名，action < 100 时必选

            "location": [ 5, 5 ],   // 部署干员的位置。action == 0 时必选

            "direction": 0,         // 部署干员的干员朝向。action == 0 时必选
                                    // 0 - 右； 1 - 下； 2 - 左； 3 - 上
                                    // 4 - 无朝向（适用于召唤物）

            "pre_delay": 0,         // 前置延时。可选，默认 0, 单位毫秒
            "rear_delay": 0,        // 后置延时。可选，默认 0, 单位毫秒

            "timeout": 999999999    // 超时时间。可选，默认 INT_MAX, 单位毫秒
                                    // 当 type == 0 或 type == 1 且等待超时
                                    // 则放弃当前动作, 转而执行下一个动作
        },
                                    // 举例 1
        {
            "name": "任意正常群奶",
            "location": [ 5, 6 ],
            "direction": 1
        },
                                    // 举例 2
        {
            "type": 100
        }
    ],
    "minimum_required": "v4.0",      // 最低要求 maa 版本号，必选。保留字段
    "desc": {                       // 描述，可选，保留字段。
                                    // 后期完成了作业分享平台后，可能直接展示该字段给其他用户看
        "title": "低练度高成功率作业",
        "details": "对练度要求很低balabala……",
        "requirements": "棘刺精二、任意群奶、……"
    },
}
```
